/*!
 * audio-player v0.1.0
 * (c) 2017-2017 Clay
 * Released under the MIT License.
 */
!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):r.AudioPlayer=t()}(this,function(){"use strict";!function(r,t){if("undefined"==typeof document)return t;r=r||"";var e=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e.appendChild(n),n.styleSheet?n.styleSheet.cssText=r:n.appendChild(document.createTextNode(r))}("\r\n/* 所有rem x 40 = 设计稿尺寸*/\r\n.audio-player {\r\n  position: relative;\r\n  background-color: #fff;\r\n}\r\n.audio-player--audio {\r\n  display: none;\r\n  visibility: hidden;\r\n  opacity: 0;\r\n}\r\n.audio-bg {\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n}\r\n.audio-bg--img {\r\n  width: 100%;\r\n}\r\n.audio-bar {\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: flex;\r\n  -webkit-box-align: center;\r\n  -webkit-align-items: center;\r\n          align-items: center;\r\n  padding: 0 1rem;\r\n}\r\n.audio-bar__time {\r\n  margin-left: 1.05rem;\r\n  color: #eee;\r\n  /*line-height: 36px;*/\r\n  font-size: 0.6rem;\r\n}\r\n.audio-bar__progress {\r\n  position: relative;\r\n  -webkit-box-flex: 1;\r\n  -webkit-flex: 1;\r\n          flex: 1;\r\n  margin: 0.925rem 0;\r\n  height: 0.45rem;\r\n}\r\n.audio-bar__loading {\r\n  position: absolute;\r\n  z-index: 1;\r\n  left: -0.375rem;\r\n  top: 0;\r\n}\r\n.audio-bar__progress-box {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 0;\r\n  right: 0;\r\n  -webkit-transform: translateY(-50%);\r\n          transform: translateY(-50%);\r\n}\r\n.audio-bar__progress--bg {\r\n  height: 0.125rem;\r\n  background-color: #777;\r\n  border-radius: 0.0625rem;\r\n}\r\n.audio-bar__progress--now {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 0;\r\n  height: 0.125rem;\r\n  background-color: #fff;\r\n  border-radius: 0.0625rem;\r\n}\r\n.audio-bar__progress--now.loaded:after {\r\n  content: '';\r\n  position: absolute;\r\n  right: 0;\r\n  top: 50%;\r\n  -webkit-transform: translate(50%, -50%);\r\n          transform: translate(50%, -50%);\r\n  width: 0.45rem;\r\n  height: 0.45rem;\r\n  border-radius: 50%;\r\n  background-color: #fff;\r\n}\r\n.audio-bar__btn {\r\n  position: absolute;\r\n  left: 1rem;\r\n  bottom: 2.3rem;\r\n  width: 2rem;\r\n  height: 2rem;\r\n  color: #fff;\r\n  -webkit-tap-highlight-color: transparent;\r\n}\r\n.audio-bar__btn.play {\r\n  background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAMAAAC5zwKfAAAAolBMVEUAAAAAAAD9/f0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD9/f0AAAD6+vpTU1Pw8PDr6+u3t7ewsLCBgYFjY2Pp6enY2NjV1dXIyMj+/v77+/v4+Pj29vb09PTt7e3l5eXi4uLR0dHNzc3CwsK/v7+np6dwcHA2Njb7+/vy8vLt7e3t7e3d3d27u7srKyv///8R4QqsAAAANXRSTlMzAPUwLQcEHisSDiclGBYPIfcd7EXPwXhyVkq9npmJ+vDm3drIs66UjoGAa0498dLJxad8O7UE/foAAAJKSURBVFjDzdnpUtswFIbhr5Ys70tishCSsralQPfq/m+tbKmGytbRkRqG5z/vTAZZlo7xzk2VbVbnQgBC5nXWlor4A2ewm+ew5PMuLFj2AhNEX7KDrYSTbFnBRoAkGu9gIeFFFl7BtIa3OqWDhQCDKKhgBqbeGVQV2Co1HUwlAsjUDppedBFEj100QSURTKqRYIUIlR3MECX7N1jAtr5MLj/BU/EymApYjvWDxTG8iPRFsIZtqZ9cw0ttguM/GIN+9v3O80eboMSIRO+d3sCDNMEG40FjewRa8zcoyKBO3oMk9sEW00FjuQGlfQ5Kr6BOViDIp2AJd9DYgVA+BnsqaHwjVnn/GBR00Lj+DQfxEOzACephDYfuPpgRQYtrv8jug5Ib1Is7x/8ZCuygPp1e5QolI2gspx7FDk1QUJ/dYlSDjBc0fmwwIkMVGtSzG9gq5OygsYUlh4gIanu7EHHBi5EgYoIJCNzgDDYRExxGcjImuLODUcvmCpYcVXjwI2xV+KN3sRp/9JrA4MQO1gRuX8Pt5PalQoIfvmCCCnkFJL8wRRIvKWK3tmX81+hsC4eO/aI/OYKD4B5FZp/h1DMPS1cbuJWs45z+CYJkHTiHNSgtcSS21jJBMA7tXtefhrhWzKyNyk1SF5+zfe7rCj4K6mq2MGvZR01eHtdmLXsQKX293Z0n5ycb+CkOewGPHxEceIgRP2Y58CDIFHMEyNNXGKYZczDNqYFkxxtIdgcdmcYPdV997GwoejCu/u/o/i18XLA+fwivzx9/AIAT35xYsL7EAAAAAElFTkSuQmCC') no-repeat;\r\n  background-size: 100% 100%;\r\n}\r\n.audio-bar__btn.pause {\r\n  background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAMAAAC5zwKfAAAASFBMVEUAAAAAAACbm5sAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADc3NwAAAD7+/v9/f3q6up5eXlYWFgbGxv8/Pzy8vLy8vL///+mywzUAAAAF3RSTlMzAGMuBioXDiAlEh2lEPH5v1JGOPHU02yQnmwAAAGXSURBVFjDzdnJEoMgEATQNsMqmn35/z9NYg6UCyKhD/aRwyuoUhgGNOtR1gSvBYBo7YOxqlnPKmiDxiw62P9A65CMs8WgEaxGTArMcXkyD7aCTZF2E6g8NserPNgKCiJtDnQojFsFlUZxtJqBVV4U56AS/BVRMzB61SLq1htXPQc1KqLnoENV3BRsUZl2DCqpBUWNQI/q+AjGBVcuOoLCACWCBku5dcfT+YpJrufTvbthKWYA0xPsXp88McnzO9qlp4jkBHF8fXPBKJdh8IjkFJH+R15DDhjl8BvFYuQHWrBA2AF0PNANIHggvmDPBPsPGJhg+ICaCeoGCkwQCpYLWhguaOC4oIPngh6aC2oIFxQaGLN7UHYOCv2zoX/Y9F+PvjnQty/6Bss/AhrHBAP/GOUf9PxShF8sNcIChV9w5kviByZ55EvidNF+Lyza2dcK/sWHfzXjXx7511v+BZzfIuA3MfhtFn4jiN+qiqIv97xabfeFUi/kGpK9lHDSs1um5KYuue1MboyTW/d7eFyYPn9ANj1/vAGhMDNHuA/PmwAAAABJRU5ErkJggg==') no-repeat;\r\n  background-size: 100% 100%;\r\n}\r\n.small-loading {\r\n  width: 0.4rem;\r\n  height: 0.4rem;\r\n  display: inline-block;\r\n  vertical-align: middle;\r\n  -webkit-animation: weuiLoading 1s steps(12, end) infinite;\r\n  animation: weuiLoading 1s steps(12, end) infinite;\r\n  background: transparent url(\"data:image/svg+xml;charset=utf8, %3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 100 100'%3E%3Cpath fill='none' d='M0 0h100v100H0z'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23E9E9E9' rx='5' ry='5' transform='translate(0 -30)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23989697' rx='5' ry='5' transform='rotate(30 105.98 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%239B999A' rx='5' ry='5' transform='rotate(60 75.98 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23A3A1A2' rx='5' ry='5' transform='rotate(90 65 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23ABA9AA' rx='5' ry='5' transform='rotate(120 58.66 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23B2B2B2' rx='5' ry='5' transform='rotate(150 54.02 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23BAB8B9' rx='5' ry='5' transform='rotate(180 50 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23C2C0C1' rx='5' ry='5' transform='rotate(-150 45.98 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23CBCBCB' rx='5' ry='5' transform='rotate(-120 41.34 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23D2D2D2' rx='5' ry='5' transform='rotate(-90 35 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23DADADA' rx='5' ry='5' transform='rotate(-60 24.02 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23E2E2E2' rx='5' ry='5' transform='rotate(-30 -5.98 65)'/%3E%3C/svg%3E\") no-repeat;\r\n  background-size: 100%;\r\n}\r\n@-webkit-keyframes weuiLoading {\r\n  0% {\r\n    -webkit-transform: rotate3d(0, 0, 1, 0deg);\r\n            transform: rotate3d(0, 0, 1, 0deg);\r\n  }\r\n\r\n  100% {\r\n    -webkit-transform: rotate3d(0, 0, 1, 360deg);\r\n            transform: rotate3d(0, 0, 1, 360deg);\r\n  }\r\n}\r\n\r\n@keyframes weuiLoading {\r\n  0% {\r\n    -webkit-transform: rotate3d(0, 0, 1, 0deg);\r\n            transform: rotate3d(0, 0, 1, 0deg);\r\n  }\r\n\r\n  100% {\r\n    -webkit-transform: rotate3d(0, 0, 1, 360deg);\r\n            transform: rotate3d(0, 0, 1, 360deg);\r\n  }\r\n}\r\n",void 0),function(r){var t=navigator.userAgent.toLocaleLowerCase(),e="onorientationchange"in r?"orientationchange":"resize",n=/chrome|firefox|ucbrowser|mqqbrowser/.test(t)||/safari/.test(t)&&/iphone/.test(t)?0:300,i=document.documentElement.clientWidth,o=window.innerWidth,a=i<o?i:o;document.documentElement.style.fontSize=a/750*40+"px",r.addEventListener(e,function(){clearTimeout(r.orientationChangedTimeout),r.orientationChangedTimeout=setTimeout(function(){document.documentElement.style.fontSize=a/750*40+"px"},n)},!1)}(window);return{render:function(){var r=this,t=r.$createElement,e=r._self._c||t;return e("div",{staticClass:"audio-player",style:{width:r.width+"px",height:(r.height||r.boxWidth)+"px"}},[e("audio",{staticClass:"audio-player--audio",attrs:{controls:"",title:"sleep_alone",meta:"sleep_alone",src:r.audio}}),r._v(" "),e("div",{staticClass:"audio-bg"},[e("img",{staticClass:"audio-bg--img",attrs:{src:r.img,alt:""}})]),r._v(" "),e("div",{staticClass:"audio-bar"},[e("div",{staticClass:"audio-bar__progress",on:{touchmove:function(t){r._barTouchmove(t)},touchend:function(t){r._barTouchend(t)}}},[e("div",{directives:[{name:"show",rawName:"v-show",value:!r.loaded,expression:"!loaded"}],staticClass:"small-loading audio-bar__loading"}),r._v(" "),e("div",{staticClass:"audio-bar__progress-box"},[e("div",{staticClass:"audio-bar__progress--bg"}),r._v(" "),e("div",{staticClass:"audio-bar__progress--now",class:{loaded:r.loaded},style:{width:r.currentTime/r.duration*100+"%"}})])]),r._v(" "),e("div",{staticClass:"audio-bar__time",domProps:{innerHTML:r._s(r.timeFormatter(r.condown?r.totalTime||0:r.currentTime))}}),r._v(" "),e("div",{class:["audio-bar__btn",{play:!r.playing,pause:r.playing}],on:{click:r._audioPlay}})]),r._v(" "),e("div",{staticClass:"audio-bar"})])},staticRenderFns:[],name:"audio-player",data:function(){return{duration:0,totalTime:0,currentTime:0,boxWidth:0,progressWidth:0,touching:!1,playing:!1,loaded:!0}},props:{audio:{type:String},img:{type:String},width:Number,height:Number,condown:Boolean,timeFormatter:{type:Function,default:function(r){var t=function(r){return r<10?"0"+r:r};return t(Math.floor(r/3600))+":"+t(Math.floor(r/60%60))+":"+t(Math.floor(r%3600%60))}}},watch:{audio:function(r){this.currentTime=this.$elAudio.currentTime=0}},mounted:function(){var r=this;console.log(r.loaded),r.$nextTick(function(){r.boxWidth=r.$el.clientWidth,r.$elProgress=r.$el.querySelector(".audio-bar__progress"),r.progressWidth=r.$elProgress.clientWidth,r.$elAudio=r.$el.querySelector(".audio-player--audio"),r.$elAudio.addEventListener("durationchange",function(){r.duration=r.$elAudio.duration,r.audioInterval=setInterval(function(){r.touching||(r.currentTime=Math.ceil(r.$elAudio.currentTime),r.currentTime>0&&(r.loaded=!0),r.condown&&(r.totalTime=Math.ceil(r.$elAudio.duration)-r.currentTime))},1e3)},!1),r.$elAudio.addEventListener("canplaythrough",function(){r.loaded=!0},!1),r.$elAudio.addEventListener("pause",function(){r.playing=!1},!1)})},methods:{_barTouchmove:function(r){this.touching=!0;var t=r.changedTouches[0].clientX-this.$elProgress.offsetLeft,e=Math.floor(t/this.progressWidth*this.duration);e>this.duration&&(e=this.duration),this.currentTime=e},_barTouchend:function(r){this.touching=!1;var t=r.changedTouches[0].clientX-this.$elProgress.offsetLeft,e=Math.ceil(t/this.progressWidth*this.duration);e>this.duration&&(e=this.duration),this.currentTime=this.$elAudio.currentTime=e,this.play()},_audioPlay:function(){this.$elAudio.paused?this.play():this.pause()},play:function(){this.$elAudio.paused&&(this.$elAudio.play(),this.playing=!this.$elAudio.paused,0===this.currentTime&&(this.loaded=!1))},pause:function(){this.$elAudio.paused||(this.$elAudio.pause(),this.playing=!this.$elAudio.paused)}},destroy:function(){clearInterval(this.audioInterval)}}});
